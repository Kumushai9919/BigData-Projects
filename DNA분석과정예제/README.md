# DNA 분석 과정 
DNA 서열을 아미노산의 서열로 변환,
12개의 알파벳으로 구성되어 있는 DNA 데이터를 3개씩 잘라서 하나 의 아미노산으로 변환:

<img width="300" alt="Screenshot 2023-05-05 at 5 43 18 PM" src="https://user-images.githubusercontent.com/83897840/236414011-8cf36799-e77b-4665-8199-475715ff27bf.png">

DNA와 프로틴 시퀀스 데이터를 다운로드 -> NCBI(https://www.ncbi.nlm.nih.gov/) 접속

<img width="300" alt="Screenshot 2023-05-05 at 5 44 46 PM" src="https://user-images.githubusercontent.com/83897840/236414303-017dfbf2-162c-43ac-9515-4618be23aac8.png">
<img width="300" alt="Screenshot 2023-05-05 at 5 45 00 PM" src="https://user-images.githubusercontent.com/83897840/236414347-3df79a2d-3e8c-4f0f-bf48-3854811f4f30.png">
<img width="300" alt="Screenshot 2023-05-05 at 5 45 20 PM" src="https://user-images.githubusercontent.com/83897840/236414422-11c1b90e-0405-463b-8a5d-c0a85ce8b7ea.png">


##### 1. Read DNA file:
open() 명령을 이용하여 읽기 전용으로 파일 열기

```python
f = open("NM_207618.2.fna", "r")
seq = f.read()
seq
```
##### Result:
```
'>NM_207618.2 Mus musculus vomeronasal 1 receptor, D18 (V1rd18), mRNA\nGGTCAGAAAAAGCCCTCTCCATGTCTACTCACGATACATCCCTGAAAACCACTGAGGAAGTGGCTTTTCA\nGATCATCTTGCTTTGCCAGTTTGGGGTTGGGACTTTTGCCAATGTATTTCTCTTTGTCTATAATTTCTCT\nCCAATCTCGACTGGTTCTAAACAGAGGCCCAGACAAGTGATTTTAAGACACATGGCTGTGGCCAATGCCT\nTAACTCTCTTCCTCACTATATTTCCAAACAACATGATGACTTTTGCTCCAATTATTCCTCAAACTGACCT\nCAAATGTAAATTAGAATTCTTCACTCGCCTCGTGGCAAGAAGCACAAACTTGTGTTCAACTTGTGTTCTG\nAGTATCCATCAGTTTGTCACACTTGTTCCTGTTAATTCAGGTAAAGGAATACTCAGAGCAAGTGTCACAA\nACATGGCAAGTTATTCTTGTTACAGTTGTTGGTTCTTCAGTGTCTTAAATAACATCTACATTCCAATTAA\nGGTCACTGGTCCACAGTTAACAGACAATAACAATAACTCTAAAAGCAAGTTGTTCTGTTCCACTTCTGAT\nTTCAGTGTAGGCATTGTCTTCTTGAGGTTTGCCCATGATGCCACATTCATGAGCATCATGGTCTGGACCA\nGTGTCTCCATGGTACTTCTCCTCCATAGACATTGTCAGAGAATGCAGTACATATTCACTCTCAATCAGGA\nCCCCAGGGGCCAAGCAGAGACCACAGCAACCCATACTATCCTGATGCTGGTAGTCACATTTGTTGGCTTT\nTATCTTCTAAGTCTTATTTGTATCATCTTTTACACCTATTTTATATATTCTCATCATTCCCTGAGGCATT\nGCAATGACATTTTGGTTTCGGGTTTCCCTACAATTTCTCCTTTACTGTTGACCTTCAGAGACCCTAAGGG\nTCCTTGTTCTGTGTTCTTCAACTGTTGAAAGCCAGAGTCACTAAAAATGCCAAACACAGAAGACAGCTTT\nGCTAATACCATTAAATACTTTATTCCATAAATATGTTTTTAAAAGCTTGTATGAACAAGGTATGGTGCTC\nACTGCTATACTTATAAAAGAGTAAGGTTATAATCACTTGTTGATATGAAAAGATTTCTGGTTGGAATCTG\nATTGAAACAGTGAGTTATTCACCACCCTCCATTCTCT\n\n'
```
##### 2. 불 필요한 행 삭제: 

```python
with open("NM_207618.2.fna", "r") as inf:
    data = inf.read().splitlines(True)
with open("dna1.txt", "w") as outf:
        outf.writelines(data[1:])
f = open("dna1.txt", "r")
sequence = f.read()
sequence
```
##### Result:
```
'GGTCAGAAAAAGCCCTCTCCATGTCTACTCACGATACATCCCTGAAAACCACTGAGGAAGTGGCTTTTCA\nGATCATCTTGCTTTGCCAGTTTGGGGTTGGGACTTTTGCCAATGTATTTCTCTTTGTCTATAATTTCTCT\nCCAATCTCGACTGGTTCTAAACAGAGGCCCAGACAAGTGATTTTAAGACACATGGCTGTGGCCAATGCCT\nTAACTCTCTTCCTCACTATATTTCCAAACAACATGATGACTTTTGCTCCAATTATTCCTCAAACTGACCT\nCAAATGTAAATTAGAATTCTTCACTCGCCTCGTGGCAAGAAGCACAAACTTGTGTTCAACTTGTGTTCTG\nAGTATCCATCAGTTTGTCACACTTGTTCCTGTTAATTCAGGTAAAGGAATACTCAGAGCAAGTGTCACAA\nACATGGCAAGTTATTCTTGTTACAGTTGTTGGTTCTTCAGTGTCTTAAATAACATCTACATTCCAATTAA\nGGTCACTGGTCCACAGTTAACAGACAATAACAATAACTCTAAAAGCAAGTTGTTCTGTTCCACTTCTGAT\nTTCAGTGTAGGCATTGTCTTCTTGAGGTTTGCCCATGATGCCACATTCATGAGCATCATGGTCTGGACCA\nGTGTCTCCATGGTACTTCTCCTCCATAGACATTGTCAGAGAATGCAGTACATATTCACTCTCAATCAGGA\nCCCCAGGGGCCAAGCAGAGACCACAGCAACCCATACTATCCTGATGCTGGTAGTCACATTTGTTGGCTTT\nTATCTTCTAAGTCTTATTTGTATCATCTTTTACACCTATTTTATATATTCTCATCATTCCCTGAGGCATT\nGCAATGACATTTTGGTTTCGGGTTTCCCTACAATTTCTCCTTTACTGTTGACCTTCAGAGACCCTAAGGG\nTCCTTGTTCTGTGTTCTTCAACTGTTGAAAGCCAGAGTCACTAAAAATGCCAAACACAGAAGACAGCTTT\nGCTAATACCATTAAATACTTTATTCCATAAATATGTTTTTAAAAGCTTGTATGAACAAGGTATGGTGCTC\nACTGCTATACTTATAAAAGAGTAAGGTTATAATCACTTGTTGATATGAAAAGATTTCTGGTTGGAATCTG\nATTGAAACAGTGAGTTATTCACCACCCTCCATTCTCT\n\n'
```
##### 3. 불 필요한 문자 삭제: 

```python
seq = seq.replace('\n', '')
seq = seq.replace('\r', '')
seq = seq.replace(' ', '')
seq
```
##### Result:
```
'>NM_207618.2Musmusculusvomeronasal1receptor,D18(V1rd18),mRNAGGTCAGAAAAAGCCCTCTCCATGTCTACTCACGATACATCCCTGAAAACCACTGAGGAAGTGGCTTTTCAGATCATCTTGCTTTGCCAGTTTGGGGTTGGGACTTTTGCCAATGTATTTCTCTTTGTCTATAATTTCTCTCCAATCTCGACTGGTTCTAAACAGAGGCCCAGACAAGTGATTTTAAGACACATGGCTGTGGCCAATGCCTTAACTCTCTTCCTCACTATATTTCCAAACAACATGATGACTTTTGCTCCAATTATTCCTCAAACTGACCTCAAATGTAAATTAGAATTCTTCACTCGCCTCGTGGCAAGAAGCACAAACTTGTGTTCAACTTGTGTTCTGAGTATCCATCAGTTTGTCACACTTGTTCCTGTTAATTCAGGTAAAGGAATACTCAGAGCAAGTGTCACAAACATGGCAAGTTATTCTTGTTACAGTTGTTGGTTCTTCAGTGTCTTAAATAACATCTACATTCCAATTAAGGTCACTGGTCCACAGTTAACAGACAATAACAATAACTCTAAAAGCAAGTTGTTCTGTTCCACTTCTGATTTCAGTGTAGGCATTGTCTTCTTGAGGTTTGCCCATGATGCCACATTCATGAGCATCATGGTCTGGACCAGTGTCTCCATGGTACTTCTCCTCCATAGACATTGTCAGAGAATGCAGTACATATTCACTCTCAATCAGGACCCCAGGGGCCAAGCAGAGACCACAGCAACCCATACTATCCTGATGCTGGTAGTCACATTTGTTGGCTTTTATCTTCTAAGTCTTATTTGTATCATCTTTTACACCTATTTTATATATTCTCATCATTCCCTGAGGCATTGCAATGACATTTTGGTTTCGGGTTTCCCTACAATTTCTCCTTTACTGTTGACCTTCAGAGACCCTAAGGGTCCTTGTTCTGTGTTCTTCAACTGTTGAAAGCCAGAGTCACTAAAAATGCCAAACACAGAAGACAGCTTTGCTAATACCATTAAATACTTTATTCCATAAATATGTTTTTAAAAGCTTGTATGAACAAGGTATGGTGCTCACTGCTATACTTATAAAAGAGTAAGGTTATAATCACTTGTTGATATGAAAAGATTTCTGGTTGGAATCTGATTGAAACAGTGAGTTATTCACCACCCTCCATTCTCT'
```
##### 4. DNA에 대한 아미노산의 정보: 

```python
genetic_code = {

'ATA':'I', 'ATC':'I', 'ATT':'I', 'ATG':'M',

       
'ACA':'T', 'ACC':'T', 'ACG':'T', 'ACT':'T',

       
'AAC':'N', 'AAT':'N', 'AAA':'K', 'AAG':'K',

       
'AGC':'S', 'AGT':'S', 'AGA':'R', 'AGG':'R',

       
'CTA':'L', 'CTC':'L', 'CTG':'L', 'CTT':'L',

       
'CCA':'P', 'CCC':'P', 'CCG':'P', 'CCT':'P',

       
'CAC':'H', 'CAT':'H', 'CAA':'Q', 'CAG':'Q',

       
'CGA':'R', 'CGC':'R', 'CGG':'R', 'CGT':'R',

       
'GTA':'V', 'GTC':'V', 'GTG':'V', 'GTT':'V',

       
'GCA':'A', 'GCC':'A', 'GCG':'A', 'GCT':'A',

       
'GAC':'D', 'GAT':'D', 'GAA':'E', 'GAG':'E',

       
'GGA':'G', 'GGC':'G', 'GGG':'G', 'GGT':'G',

       
'TCA':'S', 'TCC':'S', 'TCG':'S', 'TCT':'S',

       
'TTC':'F', 'TTT':'F', 'TTA':'L', 'TTG':'L',

       
'TAC':'Y', 'TAT':'Y', 'TAA':'_', 'TAG':'_',

       
'TGC':'C', 'TGT':'C', 'TGA':'_', 'TGG':'W', }

genetic_code['ATA']
```
##### Result:
```
'I'
```
##### 5. 다운로드한 데이터를 가공해 파일에 저장: 
read_seq()
nm_207618.2.fna 파일의 첫 줄 삭제
```python
def read_seq(inputfile):
    with open(inputfile, 'r') as f:
        seq = f.read()
    seq = seq.replace('\n', '')
    seq = seq.replace('\r', '')
    seq = seq.replace(' ', '')
    return seq
with open("NM_207618.2.fna", "r") as inf:
    data = inf.read().splitlines(True)
with open('dna.txt', 'w') as outf:
    outf.writelines(data[1:])
dna = read_seq('dna.txt')
print(dna)
```
##### Result:
```
GGTCAGAAAAAGCCCTCTCCATGTCTACTCACGATACATCCCTGAAAACCACTGAGGAAGTGGCTTTTCAGATCATCTTGCTTTGCCAGTTTGGGGTTGGGACTTTTGCCAATGTATTTCTCTTTGTCTATAATTTCTCTCCAATCTCGACTGGTTCTAAACAGAGGCCCAGACAAGTGATTTTAAGACACATGGCTGTGGCCAATGCCTTAACTCTCTTCCTCACTATATTTCCAAACAACATGATGACTTTTGCTCCAATTATTCCTCAAACTGACCTCAAATGTAAATTAGAATTCTTCACTCGCCTCGTGGCAAGAAGCACAAACTTGTGTTCAACTTGTGTTCTGAGTATCCATCAGTTTGTCACACTTGTTCCTGTTAATTCAGGTAAAGGAATACTCAGAGCAAGTGTCACAAACATGGCAAGTTATTCTTGTTACAGTTGTTGGTTCTTCAGTGTCTTAAATAACATCTACATTCCAATTAAGGTCACTGGTCCACAGTTAACAGACAATAACAATAACTCTAAAAGCAAGTTGTTCTGTTCCACTTCTGATTTCAGTGTAGGCATTGTCTTCTTGAGGTTTGCCCATGATGCCACATTCATGAGCATCATGGTCTGGACCAGTGTCTCCATGGTACTTCTCCTCCATAGACATTGTCAGAGAATGCAGTACATATTCACTCTCAATCAGGACCCCAGGGGCCAAGCAGAGACCACAGCAACCCATACTATCCTGATGCTGGTAGTCACATTTGTTGGCTTTTATCTTCTAAGTCTTATTTGTATCATCTTTTACACCTATTTTATATATTCTCATCATTCCCTGAGGCATTGCAATGACATTTTGGTTTCGGGTTTCCCTACAATTTCTCCTTTACTGTTGACCTTCAGAGACCCTAAGGGTCCTTGTTCTGTGTTCTTCAACTGTTGAAAGCCAGAGTCACTAAAAATGCCAAACACAGAAGACAGCTTTGCTAATACCATTAAATACTTTATTCCATAAATATGTTTTTAAAAGCTTGTATGAACAAGGTATGGTGCTCACTGCTATACTTATAAAAGAGTAAGGTTATAATCACTTGTTGATATGAAAAGATTTCTGGTTGGAATCTGATTGAAACAGTGAGTTATTCACCACCCTCCATTCTCT
```

##### 6. 다운로드한 데이터를 가공해 파일에 저장: 
cnvert() : DNA 정보를 아미노산 시퀀스로 변환
아미노산의 DNA에 해당하는 부분은 [20:938]
```python
 def convert(seq):
    """DNA Sequence를 아미노산 시퀀스로 변환"""
    genetic_code = {
      
        'ATA':'I', 'ATC':'I', 'ATT':'I', 'ATG':'M',


        'ACA':'T', 'ACC':'T', 'ACG':'T', 'ACT':'T',


        'AAC':'N', 'AAT':'N', 'AAA':'K', 'AAG':'K',


        'AGC':'S', 'AGT':'S', 'AGA':'R', 'AGG':'R',


        'CTA':'L', 'CTC':'L', 'CTG':'L', 'CTT':'L',


        'CCA':'P', 'CCC':'P', 'CCG':'P', 'CCT':'P',


        'CAC':'H', 'CAT':'H', 'CAA':'Q', 'CAG':'Q',


        'CGA':'R', 'CGC':'R', 'CGG':'R', 'CGT':'R',


        'GTA':'V', 'GTC':'V', 'GTG':'V', 'GTT':'V',


        'GCA':'A', 'GCC':'A', 'GCG':'A', 'GCT':'A',


        'GAC':'D', 'GAT':'D', 'GAA':'E', 'GAG':'E',


        'GGA':'G', 'GGC':'G', 'GGG':'G', 'GGT':'G',


        'TCA':'S', 'TCC':'S', 'TCG':'S', 'TCT':'S',


        'TTC':'F', 'TTT':'F', 'TTA':'L', 'TTG':'L',


        'TAC':'Y', 'TAT':'Y', 'TAA':'_', 'TAG':'_',


        'TGC':'C', 'TGT':'C', 'TGA':'_', 'TGG':'W', }

    protein=''
    if len(seq)%3==0:
        for i in range(0, len(seq), 3):
            codon = seq[i:i+3]
            protein += genetic_code[codon]
        return protein
print(convert(dna[20:935]))
```
##### Result:
```
MSTHDTSLKTTEEVAFQIILLCQFGVGTFANVFLFVYNFSPISTGSKQRPRQVILRHMAVANALTLFLTIFPNNMMTFAPIIPQTDLKCKLEFFTRLVARSTNLCSTCVLSIHQFVTLVPVNSGKGILRASVTNMASYSCYSCWFFSVLNNIYIPIKVTGPQLTDNNNNSKSKLFCSTSDFSVGIVFLRFAHDATFMSIMVWTSVSMVLLLHRHCQRMQYIFTLNQDPRGQAETTATHTILMLVVTFVGFYLLSLICIIFYTYFIYSHHSLRHCNDILVSGFPTISPLLLTFRDPKGPCSVFFNC
```
